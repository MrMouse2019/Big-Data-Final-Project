module load spark/2.2.0

spark-submit --conf spark.pyspark.python=/share/apps/python/3.6.5/bin/python task1_test.py /user/hm74/NYCOpenData/2abb-gr8d.tsv.gz

from csv import reader
from itertools import islice

lines = sc.textFile("/user/hm74/NYCOpenData/2abb-gr8d.tsv.gz")

lines = lines.mapPartitions(lambda x: reader(x, delimiter='\t'))

headerArray = lines.first()

num_columns = len(headerArray)

lines = lines.mapPartitionsWithIndex(lambda idx, it: islice(it, 1, None) if idx == 0 else it)




